create procedure control(numero de registros,nombre de la tabla)





delimiter #

create procedure control(b int,d varchar(100))
begin

declare a int;

declare c int(6);
declare e int(3);
declare f int(3);
declare g int(3);


set c=1;

set a=1;

drop table if exist tabla;
create table tabla (id_us int auto_increment primary key,direccion int ,nombre int,ape_pat int,ape_mat int,foreign key(direccion)references cod(id_cod)
,foreign key(nombre)references nombre(id_nombre),foreign key(ape_pat)references ape(id_ape),foreign key(ape_mat)references ape(id_ape));
while(a<=b)do

set c=RAND()*142220;

set e=RAND()*200;

set f=RAND()*200;

set g=RAND()*200;

insert into tabla values(null,c,e,f,g);

set a=a+1;

end while;


SELECT
        
id_us,cod.colonia,cod.municipio,cod.estado,cod.cp 

FROM
 
       tabla,cod 
WHERE
        
 tabla.direccion=cod.id_cod

INTO OUTFILE
 
       'C:\\Users\\Alumnos\\Downloads\\NuevaTabla.txt'
  
      FIELDS TERMINATED BY ','
    
    LINES TERMINATED BY '-';




end
#



call control(100000);




